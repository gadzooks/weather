- forecasts = forecast_summary.forecasts
%top
%table.table.table-sm.weather-forecast.weather-forecast-summary
  %thead
    %tr.table-heading.center
      %th{scope: 'col', colspan: 10}
        Weather Forecast Summary
        %a{:href => 'https://darksky.net/poweredby', :target=>"_blank"}
          [Powered By Dark SKY]

  %thead
    %tr.header-secondary
      %td
        WEATHER ALERTS
      %td
      - forecast_summary.daily_times.each do |time|
        %td{class: 'forecast-date location-change'}
          %span.day-of-week
            =time.strftime('%a %b %d').upcase unless time.blank?

  - locations = forecasts.keys
  %tbody
    - locations.each do |loc|
    - detail = forecasts[loc]
      %tr.weather-details
        -css_class = ' center '
        %td{class: css_class}
          - detail.alerts.each do |k, v|
            %span.alert_id
              =link_to k, root_path(anchor: k)
          - if detail.alerts.blank?
            N/A
        %td.location-change
          =link_to loc.description.upcase, root_path(anchor: loc.description)
        - forecast_summary.daily_times.each do |time|
          / FIXME move a lot of this to helper code
          - daily_ts = detail.daily(time)
          - css_row_classes = add_weekend_class(time, 'precipitation location-change')
          %td{class: css_row_classes}
            -if daily_ts
              %i{class: icon_class(daily_ts.icon, daily_ts.precipProbability), title: daily_ts.summary}
